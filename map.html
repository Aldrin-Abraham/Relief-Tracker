<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Relief Tracker Crisis Map - Real-time disaster visualization">
    <title>Crisis Map | Relief Tracker</title>
    
    <!-- Favicon -->
    <link rel="icon" href="images/favicon.ico" type="image/x-icon">
    
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Open+Sans:wght@400;600;700&display=swap" rel="stylesheet">
    
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- Animate.css -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css">
    
    <!-- Leaflet CSS -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    
    <!-- Leaflet MarkerCluster CSS -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet.markercluster@1.4.1/dist/MarkerCluster.css" />
    <link rel="stylesheet" href="https://unpkg.com/leaflet.markercluster@1.4.1/dist/MarkerCluster.Default.css" />
    
    <!-- Leaflet Fullscreen CSS -->
    <link rel="stylesheet" href="https://api.mapbox.com/mapbox.js/plugins/leaflet-fullscreen/v1.0.1/leaflet.fullscreen.css" />
    
    <!-- Leaflet Search CSS -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/leaflet-search/3.0.9/leaflet-search.min.css" />
    
    <style>
        :root {
            --primary: #4361ee;
            --primary-dark: #3a0ca3;
            --primary-light: #4895ef;
            --secondary: #4cc9f0;
            --accent: #f72585;
            --danger: #e63946;
            --danger-dark: #d00000;
            --success: #38b000;
            --warning: #ffaa00;
            --light: #f8f9fa;
            --dark: #212529;
            --gray: #6c757d;
            --bg-gradient: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
            --card-bg: rgba(255, 255, 255, 0.05);
            --card-border: rgba(255, 255, 255, 0.1);
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Inter', sans-serif;
        }

        body {
            min-height: 100vh;
            background: var(--bg-gradient);
            color: var(--light);
            display: flex;
            flex-direction: column;
            line-height: 1.6;
            overflow-x: hidden;
        }

        /* Header Styles */
        header {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            background: rgba(0, 0, 0, 0.8);
            backdrop-filter: blur(10px);
            z-index: 1000;
            padding: 1rem 2rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 1px solid var(--card-border);
        }

        .logo-container {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .logo-container a {
            display: flex;
            align-items: center;
            gap: 1rem;
            text-decoration: none;
        }

        .logo-img {
            height: 50px;
            transition: transform 0.3s ease;
        }

        .logo-container:hover .logo-img {
            transform: scale(1.05);
        }

        .logo-text {
            font-family: 'Open Sans', sans-serif;
            font-weight: 700;
            font-size: 1.5rem;
            background: linear-gradient(to right, var(--primary-light), var(--secondary));
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
        }

        .logo-container:hover .logo-text {
            animation: pulseGradient 1.5s infinite;
        }

        @keyframes pulseGradient {
            0% { opacity: 1; }
            50% { opacity: 0.8; }
            100% { opacity: 1; }
        }

        /* Navigation */
        nav {
            display: flex;
            align-items: center;
            gap: 1.5rem;
        }

        .nav-link {
            color: rgba(255, 255, 255, 0.8);
            text-decoration: none;
            font-weight: 500;
            font-size: 0.95rem;
            transition: all 0.3s ease;
            padding: 0.5rem 0;
            position: relative;
        }

        .nav-link:hover {
            color: white;
        }

        .nav-link::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            width: 0;
            height: 2px;
            background: var(--primary-light);
            transition: width 0.3s ease;
        }

        .nav-link:hover::after {
            width: 100%;
        }

        .nav-link.active {
            color: white;
        }

        .nav-link.active::after {
            width: 100%;
        }

        /* Emergency Button */
        .emergency-btn {
            background: linear-gradient(135deg, var(--danger), var(--danger-dark));
            color: white;
            padding: 0.7rem 1.5rem;
            border-radius: 50px;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(230, 57, 70, 0.4);
            text-decoration: none;
            position: relative;
            overflow: hidden;
        }

        .emergency-btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
            transition: 0.5s;
        }

        .emergency-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(230, 57, 70, 0.6);
        }

        .emergency-btn:hover::before {
            left: 100%;
        }

        .status-badge {
            font-size: 0.7rem;
            background: rgba(255, 255, 255, 0.15);
            padding: 0.2rem 0.5rem;
            border-radius: 50px;
            display: inline-flex;
            align-items: center;
            gap: 0.3rem;
            margin-left: 0.5rem;
        }

        /* Main Map Container */
        .map-container {
            flex: 1;
            margin-top: 80px;
            display: flex;
            position: relative;
        }

        /* The map itself */
        #crisisMap {
            flex: 1;
            height: calc(100vh - 80px);
            z-index: 1;
        }

        /* Map Controls Panel */
        .map-controls {
            position: absolute;
            top: 20px;
            right: 20px;
            z-index: 1000;
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .control-panel {
            background: rgba(0, 0, 0, 0.7);
            backdrop-filter: blur(5px);
            border-radius: 8px;
            padding: 15px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
            border: 1px solid rgba(255, 255, 255, 0.1);
            width: 300px;
            max-height: 80vh;
            overflow-y: auto;
            display: none;
            animation: fadeInUp 0.3s ease-out;
        }

        .panel-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .panel-title {
            font-size: 1.1rem;
            font-weight: 600;
            color: white;
        }

        .close-panel {
            background: none;
            border: none;
            color: rgba(255, 255, 255, 0.5);
            font-size: 1.2rem;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .close-panel:hover {
            color: white;
        }

        /* Filter Controls */
        .filter-section {
            margin-bottom: 15px;
        }

        .filter-title {
            font-size: 0.9rem;
            font-weight: 500;
            margin-bottom: 8px;
            color: rgba(255, 255, 255, 0.8);
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .filter-options {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .filter-option {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .filter-option input[type="checkbox"] {
            appearance: none;
            -webkit-appearance: none;
            width: 16px;
            height: 16px;
            border: 1px solid rgba(255, 255, 255, 0.3);
            border-radius: 3px;
            cursor: pointer;
            position: relative;
            transition: all 0.2s ease;
        }

        .filter-option input[type="checkbox"]:checked {
            background: var(--primary);
            border-color: var(--primary);
        }

        .filter-option input[type="checkbox"]:checked::after {
            content: '\f00c';
            font-family: 'Font Awesome 6 Free';
            font-weight: 900;
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            color: white;
            font-size: 10px;
        }

        .filter-option label {
            font-size: 0.9rem;
            cursor: pointer;
            flex: 1;
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .filter-option .legend-color {
            width: 12px;
            height: 12px;
            border-radius: 2px;
            display: inline-block;
        }

        /* Layer Controls */
        .layer-controls {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .layer-btn {
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            color: white;
            padding: 8px 12px;
            border-radius: 6px;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 8px;
            transition: all 0.3s ease;
            font-size: 0.9rem;
        }

        .layer-btn:hover {
            background: rgba(255, 255, 255, 0.2);
        }

        .layer-btn.active {
            background: var(--primary);
            border-color: var(--primary);
        }

        /* Search Bar */
        .search-container {
            position: absolute;
            top: 20px;
            left: 20px;
            z-index: 1000;
            width: 300px;
        }

        .search-bar {
            width: 100%;
            padding: 10px 15px;
            border-radius: 6px;
            border: none;
            background: rgba(0, 0, 0, 0.7);
            backdrop-filter: blur(5px);
            color: white;
            font-size: 0.9rem;
            border: 1px solid rgba(255, 255, 255, 0.1);
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
        }

        .search-bar::placeholder {
            color: rgba(255, 255, 255, 0.6);
        }

        /* Map Controls Button */
        .map-control-btn {
            background: rgba(0, 0, 0, 0.7);
            backdrop-filter: blur(5px);
            color: white;
            width: 40px;
            height: 40px;
            border-radius: 6px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 1px solid rgba(255, 255, 255, 0.1);
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.3);
        }

        .map-control-btn:hover {
            background: var(--primary);
            transform: translateY(-2px);
        }

        /* Legend */
        .legend {
            position: absolute;
            bottom: 30px;
            right: 20px;
            z-index: 1000;
            background: rgba(0, 0, 0, 0.7);
            backdrop-filter: blur(5px);
            border-radius: 8px;
            padding: 15px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .legend-title {
            font-size: 0.9rem;
            font-weight: 600;
            margin-bottom: 10px;
            color: white;
        }

        .legend-items {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .legend-item {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 0.8rem;
        }

        .legend-color {
            width: 12px;
            height: 12px;
            border-radius: 2px;
        }

        /* Info Window Styles */
        .map-info-window {
            max-width: 250px;
            color: var(--dark);
        }

        .info-window-title {
            font-weight: 600;
            margin-bottom: 5px;
            color: var(--primary-dark);
            font-size: 1rem;
        }

        .info-window-subtitle {
            font-size: 0.8rem;
            color: var(--gray);
            margin-bottom: 8px;
        }

        .info-window-content {
            font-size: 0.9rem;
            margin-bottom: 10px;
        }

        .info-window-footer {
            font-size: 0.8rem;
            color: var(--gray);
            margin-top: 8px;
        }

        .info-window-btn {
            display: inline-block;
            background: var(--primary);
            color: white;
            padding: 5px 10px;
            border-radius: 4px;
            font-size: 0.8rem;
            text-decoration: none;
            margin-top: 5px;
            transition: all 0.3s ease;
        }

        .info-window-btn:hover {
            background: var(--primary-dark);
        }

        /* Footer */
        footer {
            background: rgba(0, 0, 0, 0.8);
            backdrop-filter: blur(5px);
            padding: 2rem;
            margin-top: auto;
            border-top: 1px solid var(--card-border);
        }

        .footer-container {
            max-width: 1200px;
            margin: 0 auto;
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 2rem;
        }

        .footer-logo {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            margin-bottom: 1rem;
        }

        .footer-logo a {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            text-decoration: none;
        }

        .footer-logo-img {
            height: 30px;
        }

        .footer-logo-text {
            font-family: 'Open Sans', sans-serif;
            font-weight: 700;
            font-size: 1.2rem;
            color: white;
        }

        .footer-description {
            font-size: 0.9rem;
            opacity: 0.7;
            margin-bottom: 1.5rem;
        }

        .social-links {
            display: flex;
            gap: 1rem;
        }

        .social-link {
            color: white;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.1);
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
        }

        .social-link:hover {
            background: var(--primary);
            transform: translateY(-3px);
        }

        .footer-column-title {
            font-size: 1.1rem;
            font-weight: 600;
            margin-bottom: 1.5rem;
            color: white;
        }

        .footer-links-list {
            list-style: none;
        }

        .footer-link {
            margin-bottom: 0.8rem;
        }

        .footer-link a {
            color: rgba(255, 255, 255, 0.7);
            text-decoration: none;
            transition: all 0.3s ease;
            font-size: 0.9rem;
        }

        .footer-link a:hover {
            color: white;
            padding-left: 5px;
        }

        .footer-bottom {
            text-align: center;
            padding-top: 2rem;
            margin-top: 2rem;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
            font-size: 0.8rem;
            opacity: 0.7;
        }

        /* Emergency Modal */
        .emergency-modal {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.9);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 2000;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.3s ease;
        }

        .emergency-modal.active {
            opacity: 1;
            pointer-events: all;
        }

        .modal-content {
            background: #1a1a2e;
            border-radius: 15px;
            padding: 2.5rem;
            width: 90%;
            max-width: 500px;
            text-align: center;
            position: relative;
            transform: translateY(20px);
            transition: transform 0.3s ease;
            border: 1px solid rgba(255, 255, 255, 0.1);
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
        }

        .emergency-modal.active .modal-content {
            transform: translateY(0);
        }

        .close-modal {
            position: absolute;
            top: 1rem;
            right: 1rem;
            background: none;
            border: none;
            font-size: 1.5rem;
            cursor: pointer;
            color: rgba(255, 255, 255, 0.5);
            transition: all 0.3s ease;
        }

        .close-modal:hover {
            color: white;
        }

        .modal-title {
            font-size: 1.5rem;
            margin-bottom: 1.5rem;
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
        }

        .modal-title i {
            color: var(--danger);
        }

        .call-status {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.8rem;
            margin: 1.5rem 0;
            padding: 1rem;
            border-radius: 8px;
            font-weight: 500;
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .status-connecting {
            color: var(--warning);
        }

        .status-connected {
            color: var(--success);
        }

        .emergency-number-display {
            font-size: 1.5rem;
            margin: 2rem 0;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 1rem;
            background: rgba(230, 57, 70, 0.1);
            padding: 1rem;
            border-radius: 8px;
            border: 1px solid rgba(230, 57, 70, 0.3);
        }

        .emergency-number-display i {
            color: var(--danger);
        }

        .emergency-options {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1rem;
            margin-top: 2rem;
        }

        .option-btn {
            padding: 1rem;
            border-radius: 8px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            background: rgba(255, 255, 255, 0.05);
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            gap: 0.8rem;
            color: white;
        }

        .option-btn:hover {
            background: rgba(255, 255, 255, 0.1);
            transform: translateY(-3px);
        }

        .option-btn i {
            font-size: 1.5rem;
        }

        .option-btn span {
            font-size: 0.9rem;
        }

        .option-btn-primary {
            grid-column: span 2;
            background: linear-gradient(135deg, var(--danger), var(--danger-dark));
        }

        .option-btn-primary:hover {
            background: linear-gradient(135deg, var(--danger-dark), var(--danger));
        }

        .modal-note {
            margin-top: 2rem;
            font-size: 0.8rem;
            opacity: 0.7;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
        }

        .modal-note i {
            color: var(--warning);
        }

        /* Animations */
        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes pulseGradient {
            0% { opacity: 1; }
            50% { opacity: 0.8; }
            100% { opacity: 1; }
        }

        /* Responsive Styles */
        @media (max-width: 992px) {
            .control-panel {
                width: 280px;
            }
            
            .search-container {
                width: 280px;
            }
        }

        @media (max-width: 768px) {
            header {
                padding: 1rem;
            }
            
            .logo-text {
                display: none;
            }
            
            .control-panel {
                width: 260px;
                max-height: 70vh;
            }
            
            .search-container {
                width: calc(100% - 40px);
                left: 20px;
                top: 90px;
            }
        }

        @media (max-width: 576px) {
            .control-panel {
                width: calc(100% - 40px);
                right: 20px;
                left: 20px;
                top: 140px;
            }
            
            .legend {
                bottom: 80px;
                left: 20px;
                right: auto;
            }
        }
    </style>
</head>
<body>
    <!-- Header with Navigation -->
    <header>
        <div class="logo-container">
            <a href="index.html">
                <img src="images/Logo.png" alt="Relief Tracker Logo" class="logo-img">
                <span class="logo-text">Relief Tracker</span>
            </a>
        </div>
        
        <nav>
            <a href="about.html" class="nav-link">About</a>
            <a href="volunteer.html" class="nav-link">Volunteer</a>
            <a href="donate.html" class="nav-link">Donate</a>
            <a href="resources.html" class="nav-link">Resources</a>
            <a href="contact.html" class="nav-link">Contact</a>
            <a href="tel:+11234567890" class="emergency-btn">
                <i class="fas fa-phone-alt"></i>
                <span class="visible-label">EMERGENCY</span>
                <span class="status-badge">
                    <i class="fas fa-circle"></i> LIVE
                </span>
            </a>
        </nav>
    </header>

    <!-- Main Map Container -->
    <div class="map-container">
        <!-- Search Bar -->
        <div class="search-container">
            <input type="text" class="search-bar" placeholder="Search location or incident..." id="mapSearch">
        </div>
        
        <!-- The Map -->
        <div id="crisisMap"></div>
        
        <!-- Map Controls Button -->
        <div class="map-controls">
            <div class="map-control-btn" id="toggleControls">
                <i class="fas fa-layer-group"></i>
            </div>
        </div>
        
        <!-- Map Controls Panel (initially hidden) -->
        <div class="control-panel" id="mapControlPanel">
            <div class="panel-header">
                <div class="panel-title">Map Controls</div>
                <button class="close-panel" id="closePanel">&times;</button>
            </div>
            
            <div class="filter-section">
                <div class="filter-title">Disaster Types</div>
                <div class="filter-options">
                    <div class="filter-option">
                        <input type="checkbox" id="floodFilter" checked>
                        <label for="floodFilter">
                            <span class="legend-color" style="background: #4361ee;"></span>
                            Floods
                        </label>
                    </div>
                    <div class="filter-option">
                        <input type="checkbox" id="wildfireFilter" checked>
                        <label for="wildfireFilter">
                            <span class="legend-color" style="background: #f72585;"></span>
                            Wildfires
                        </label>
                    </div>
                    <div class="filter-option">
                        <input type="checkbox" id="earthquakeFilter" checked>
                        <label for="earthquakeFilter">
                            <span class="legend-color" style="background: #4cc9f0;"></span>
                            Earthquakes
                        </label>
                    </div>
                    <div class="filter-option">
                        <input type="checkbox" id="hurricaneFilter" checked>
                        <label for="hurricaneFilter">
                            <span class="legend-color" style="background: #4895ef;"></span>
                            Hurricanes
                        </label>
                    </div>
                </div>
            </div>
            
            <div class="filter-section">
                <div class="filter-title">Response Resources</div>
                <div class="filter-options">
                    <div class="filter-option">
                        <input type="checkbox" id="shelterFilter" checked>
                        <label for="shelterFilter">
                            <span class="legend-color" style="background: #38b000;"></span>
                            Shelters
                        </label>
                    </div>
                    <div class="filter-option">
                        <input type="checkbox" id="medicalFilter" checked>
                        <label for="medicalFilter">
                            <span class="legend-color" style="background: #e63946;"></span>
                            Medical Centers
                        </label>
                    </div>
                    <div class="filter-option">
                        <input type="checkbox" id="foodFilter" checked>
                        <label for="foodFilter">
                            <span class="legend-color" style="background: #ffaa00;"></span>
                            Food Distribution
                        </label>
                    </div>
                    <div class="filter-option">
                        <input type="checkbox" id="rescueFilter" checked>
                        <label for="rescueFilter">
                            <span class="legend-color" style="background: #3a0ca3;"></span>
                            Rescue Teams
                        </label>
                    </div>
                </div>
            </div>
            
            <div class="filter-section">
                <div class="filter-title">Map Layers</div>
                <div class="layer-controls">
                    <button class="layer-btn active" data-layer="satellite">
                        <i class="fas fa-satellite"></i> Satellite View
                    </button>
                    <button class="layer-btn" data-layer="streets">
                        <i class="fas fa-map"></i> Street Map
                    </button>
                    <button class="layer-btn" data-layer="terrain">
                        <i class="fas fa-mountain"></i> Terrain
                    </button>
                </div>
            </div>
        </div>
        
        <!-- Map Legend -->
        <div class="legend">
            <div class="legend-title">Map Legend</div>
            <div class="legend-items">
                <div class="legend-item">
                    <div class="legend-color" style="background: #4361ee;"></div>
                    <span>Flood Areas</span>
                </div>
                <div class="legend-item">
                    <div class="legend-color" style="background: #f72585;"></div>
                    <span>Wildfires</span>
                </div>
                <div class="legend-item">
                    <div class="legend-color" style="background: #4cc9f0;"></div>
                    <span>Earthquakes</span>
                </div>
                <div class="legend-item">
                    <div class="legend-color" style="background: #38b000;"></div>
                    <span>Shelters</span>
                </div>
                <div class="legend-item">
                    <div class="legend-color" style="background: #e63946;"></div>
                    <span>Medical Centers</span>
                </div>
            </div>
        </div>
    </div>

    <!-- Footer -->
    <footer>
        <div class="footer-container">
            <div class="footer-column">
                <div class="footer-logo">
                    <a href="index.html">
                        <img src="images/Logo.png" alt="Relief Tracker Logo" class="footer-logo-img">
                        <span class="footer-logo-text">Relief Tracker</span>
                    </a>
                </div>
                <p class="footer-description">
                    A comprehensive disaster management platform connecting communities with responders for faster, more effective relief efforts.
                </p>
                <div class="social-links">
                    <a href="#" class="social-link"><i class="fab fa-twitter"></i></a>
                    <a href="#" class="social-link"><i class="fab fa-facebook-f"></i></a>
                    <a href="#" class="social-link"><i class="fab fa-linkedin-in"></i></a>
                    <a href="#" class="social-link"><i class="fab fa-instagram"></i></a>
                </div>
            </div>
            
            <div class="footer-column">
                <h3 class="footer-column-title">Quick Links</h3>
                <ul class="footer-links-list">
                    <li class="footer-link"><a href="about.html">About Us</a></li>
                    <li class="footer-link"><a href="volunteer.html">Volunteer Opportunities</a></li>
                    <li class="footer-link"><a href="donate.html">Donate Resources</a></li>
                    <li class="footer-link"><a href="training.html">Responder Training</a></li>
                    <li class="footer-link"><a href="blog.html">Disaster Blog</a></li>
                </ul>
            </div>
            
            <div class="footer-column">
                <h3 class="footer-column-title">Resources</h3>
                <ul class="footer-links-list">
                    <li class="footer-link"><a href="safety.html">Safety Guidelines</a></li>
                    <li class="footer-link"><a href="preparedness.html">Preparedness Checklist</a></li>
                    <li class="footer-link"><a href="faq.html">FAQ</a></li>
                    <li class="footer-link"><a href="glossary.html">Disaster Glossary</a></li>
                    <li class="footer-link"><a href="reports.html">Annual Reports</a></li>
                </ul>
            </div>
            
            <div class="footer-column">
                <h3 class="footer-column-title">Legal</h3>
                <ul class="footer-links-list">
                    <li class="footer-link"><a href="privacy.html">Privacy Policy</a></li>
                    <li class="footer-link"><a href="terms.html">Terms of Service</a></li>
                    <li class="footer-link"><a href="cookies.html">Cookie Policy</a></li>
                    <li class="footer-link"><a href="contact.html">Contact Us</a></li>
                </ul>
            </div>
        </div>
        
        <div class="footer-bottom">
            <p>&copy; 2025 Relief Tracker. All rights reserved. | Disaster Management System</p>
        </div>
    </footer>

    <!-- Emergency Modal -->
    <div id="emergencyModal" class="emergency-modal">
        <div class="modal-content">
            <button class="close-modal" id="closeModal">&times;</button>
            
            <h2 class="modal-title">
                <i class="fas fa-exclamation-triangle"></i> Emergency Assistance
            </h2>
            
            <div id="callStatus" class="call-status status-connecting">
                <i class="fas fa-spinner fa-spin"></i>
                <span>Connecting to emergency services...</span>
            </div>
            
            <div class="emergency-number-display">
                <i class="fas fa-phone"></i> +1 (123) 456-7890
            </div>
            
            <div class="emergency-options">
                <button id="callNowBtn" class="option-btn option-btn-primary">
                    <i class="fas fa-phone"></i>
                    <span>CALL NOW</span>
                </button>
                
                <button id="requestCallbackBtn" class="option-btn">
                    <i class="fas fa-phone-volume"></i>
                    <span>Request Callback</span>
                </button>
                
                <button id="smsHelpBtn" class="option-btn">
                    <i class="fas fa-sms"></i>
                    <span>Text HELP</span>
                </button>
                
                <button id="whatsappBtn" class="option-btn">
                    <i class="fab fa-whatsapp"></i>
                    <span>WhatsApp</span>
                </button>
                
                <button id="local911Btn" class="option-btn">
                    <i class="fas fa-ambulance"></i>
                    <span>Local Emergency</span>
                </button>
            </div>
            
            <p class="modal-note">
                <i class="fas fa-info-circle"></i> For immediate life-threatening emergencies, call local 911 first.
            </p>
        </div>
    </div>

    <!-- Leaflet JS -->
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    
    <!-- Leaflet MarkerCluster -->
    <script src="https://unpkg.com/leaflet.markercluster@1.4.1/dist/leaflet.markercluster.js"></script>
    
    <!-- Leaflet Fullscreen -->
    <script src="https://api.mapbox.com/mapbox.js/plugins/leaflet-fullscreen/v1.0.1/Leaflet.fullscreen.min.js"></script>
    
    <!-- Leaflet Search -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet-search/3.0.9/leaflet-search.min.js"></script>
    
    <script>
        // Map Initialization and Configuration
        const initializeMap = () => {
            const map = L.map('crisisMap').setView([20, 0], 2);
            
            // Base Layers
            const baseLayers = {
                "Satellite": L.tileLayer('https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}', {
                    attribution: 'Tiles &copy; Esri &mdash; Source: Esri, i-cubed, USDA, USGS, AEX, GeoEye, Getmapping, Aerogrid, IGN, IGP, UPR-EGP, and the GIS User Community',
                    maxZoom: 19
                }),
                "Streets": L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{y}/{x}.png', {
                    attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors',
                    maxZoom: 19
                }),
                "Terrain": L.tileLayer('https://{s}.tile.opentopomap.org/{z}/{y}/{x}.png', {
                    attribution: 'Map data: &copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors, <a href="http://viewfinderpanoramas.org">SRTM</a> | Map style: &copy; <a href="https://opentopomap.org">OpenTopoMap</a> (<a href="https://creativecommons.org/licenses/by-sa/3.0/">CC-BY-SA</a>)',
                    maxZoom: 17
                })
            };
            
            // Add default layer
            baseLayers.Satellite.addTo(map);
            
            // Add fullscreen control
            map.addControl(new L.Control.Fullscreen());
            
            return { map, baseLayers };
        };

        // Layer Management
        const setupLayers = (map) => {
            // Disaster Layers
            const floodLayer = L.layerGroup();
            const wildfireLayer = L.layerGroup();
            const earthquakeLayer = L.layerGroup();
            const hurricaneLayer = L.layerGroup();
            
            // Resource Layers
            const shelterLayer = L.layerGroup();
            const medicalLayer = L.layerGroup();
            const foodLayer = L.layerGroup();
            const rescueLayer = L.layerGroup();
            
            // Add all overlay layers to map initially
            [floodLayer, wildfireLayer, earthquakeLayer, hurricaneLayer, 
             shelterLayer, medicalLayer, foodLayer, rescueLayer].forEach(layer => layer.addTo(map));
            
            // Create marker clusters
            const disasterCluster = L.markerClusterGroup();
            const resourceCluster = L.markerClusterGroup();
            
            // Add clusters to map
            map.addLayer(disasterCluster);
            map.addLayer(resourceCluster);
            
            return {
                disasterLayers: { floodLayer, wildfireLayer, earthquakeLayer, hurricaneLayer },
                resourceLayers: { shelterLayer, medicalLayer, foodLayer, rescueLayer },
                clusters: { disasterCluster, resourceCluster }
            };
        };

        // Marker Creation Utilities
        const createDisasterIcon = (type) => {
            const iconColors = {
                flood: '#4361ee',
                wildfire: '#f72585',
                earthquake: '#4cc9f0',
                hurricane: '#4895ef'
            };
            
            return L.divIcon({
                className: 'disaster-icon',
                html: `<div style="background: ${iconColors[type]}; 
                                 width: 20px; 
                                 height: 20px; 
                                 border-radius: 50%; 
                                 border: 2px solid white;
                                 box-shadow: 0 0 5px rgba(0,0,0,0.5);"></div>`,
                iconSize: [24, 24],
                iconAnchor: [12, 12]
            });
        };

        const createResourceIcon = (type) => {
            const iconColors = {
                shelter: '#38b000',
                medical: '#e63946',
                food: '#ffaa00',
                rescue: '#3a0ca3'
            };
            
            const icons = {
                shelter: 'fa-house',
                medical: 'fa-hospital',
                food: 'fa-utensils',
                rescue: 'fa-people-carry'
            };
            
            return L.divIcon({
                className: 'resource-icon',
                html: `<div style="background: ${iconColors[type]}; 
                                 width: 24px; 
                                 height: 24px; 
                                 border-radius: 4px; 
                                 display: flex;
                                 align-items: center;
                                 justify-content: center;
                                 border: 2px solid white;
                                 box-shadow: 0 0 5px rgba(0,0,0,0.5);">
                            <i class="fas ${icons[type]}" style="color: white; font-size: 12px;"></i>
                        </div>`,
                iconSize: [24, 24],
                iconAnchor: [12, 12]
            });
        };

        // Data Population
        const populateMapData = (map, layers) => {
            // Sample data for disasters (in a real app, this would come from an API)
            const disasters = [
                {
                    type: 'flood',
                    name: 'Mississippi River Flooding',
                    location: [38.6270, -90.1994],
                    severity: 'High',
                    date: '2023-05-15',
                    description: 'Major flooding along the Mississippi River affecting multiple states. Evacuations underway.',
                    affected: 250000
                },
                {
                    type: 'wildfire',
                    name: 'California Wildfire',
                    location: [34.0522, -118.2437],
                    severity: 'Extreme',
                    date: '2023-06-20',
                    description: 'Fast-moving wildfire threatening residential areas. 10,000 acres burned so far.',
                    affected: 50000
                },
                {
                    type: 'earthquake',
                    name: 'Alaska Earthquake',
                    location: [61.2181, -149.9003],
                    severity: '7.2 Magnitude',
                    date: '2023-06-10',
                    description: 'Major earthquake with aftershocks continuing. Infrastructure damage reported.',
                    affected: 100000
                },
                {
                    type: 'hurricane',
                    name: 'Hurricane Elena',
                    location: [27.6648, -81.5158],
                    severity: 'Category 3',
                    date: '2023-06-05',
                    description: 'Hurricane making landfall with 120mph winds. Coastal evacuations ordered.',
                    affected: 1000000
                }
            ];
            
            // Sample data for resources
            const resources = [
                {
                    type: 'shelter',
                    name: 'Central High School Shelter',
                    location: [38.6350, -90.2000],
                    capacity: 500,
                    status: 'Open',
                    contact: '314-555-1234',
                    needs: 'Blankets, toiletries'
                },
                {
                    type: 'medical',
                    name: 'Field Medical Unit #12',
                    location: [38.6400, -90.2100],
                    capacity: 50,
                    status: 'Limited capacity',
                    contact: '314-555-5678',
                    needs: 'Medical supplies, volunteers'
                },
                {
                    type: 'food',
                    name: 'Food Distribution Center',
                    location: [38.6300, -90.1900],
                    capacity: 1000,
                    status: 'Open',
                    contact: '314-555-9012',
                    needs: 'Non-perishable food'
                },
                {
                    type: 'rescue',
                    name: 'Urban Search & Rescue Team 5',
                    location: [38.6250, -90.1950],
                    capacity: 20,
                    status: 'Active',
                    contact: '314-555-3456',
                    needs: 'None'
                }
            ];
            
            // Add more sample data points
            for (let i = 0; i < 20; i++) {
                // Add more disasters
                disasters.push({
                    type: ['flood', 'wildfire', 'earthquake', 'hurricane'][Math.floor(Math.random() * 4)],
                    name: ['Major ', 'Severe ', 'Critical '][Math.floor(Math.random() * 3)] + 
                          ['Disaster', 'Event', 'Incident', 'Situation'][Math.floor(Math.random() * 4)],
                    location: [38.6 + Math.random() * 0.1 - 0.05, -90.2 + Math.random() * 0.1 - 0.05],
                    severity: ['Low', 'Moderate', 'High', 'Extreme'][Math.floor(Math.random() * 4)],
                    date: '2023-06-' + (10 + Math.floor(Math.random() * 10)),
                    description: 'This is a sample disaster description with important details for responders.',
                    affected: Math.floor(Math.random() * 100000)
                });
                
                // Add more resources
                resources.push({
                    type: ['shelter', 'medical', 'food', 'rescue'][Math.floor(Math.random() * 4)],
                    name: ['Central', 'North', 'South', 'East', 'West'][Math.floor(Math.random() * 5)] + ' ' +
                          ['Shelter', 'Aid Station', 'Relief Center', 'Command Post'][Math.floor(Math.random() * 4)],
                    location: [38.6 + Math.random() * 0.1 - 0.05, -90.2 + Math.random() * 0.1 - 0.05],
                    capacity: Math.floor(Math.random() * 500),
                    status: ['Open', 'Limited', 'Full', 'Closed'][Math.floor(Math.random() * 4)],
                    contact: '314-555-' + (1000 + Math.floor(Math.random() * 9000)),
                    needs: ['Blankets', 'Food', 'Water', 'Medical supplies', 'Volunteers'][Math.floor(Math.random() * 5)]
                });
            }
            
            // Add disasters to the map
            disasters.forEach(disaster => {
                const marker = L.marker(disaster.location, {
                    icon: createDisasterIcon(disaster.type)
                });
                
                const popupContent = `
                    <div class="map-info-window">
                        <h3 class="info-window-title">${disaster.name}</h3>
                        <div class="info-window-subtitle">
                            <i class="fas fa-${disaster.type === 'wildfire' ? 'fire' : 
                                              disaster.type === 'flood' ? 'water' : 
                                              disaster.type === 'earthquake' ? 'mountain' : 'wind'}"></i>
                            ${disaster.type.charAt(0).toUpperCase() + disaster.type.slice(1)} | ${disaster.severity}
                        </div>
                        <div class="info-window-content">
                            <p>${disaster.description}</p>
                            <p><strong>Affected:</strong> ${disaster.affected.toLocaleString()} people</p>
                            <p><strong>Date:</strong> ${disaster.date}</p>
                        </div>
                        <div class="info-window-footer">
                            <a href="#" class="info-window-btn">View Details</a>
                        </div>
                    </div>
                `;
                
                marker.bindPopup(popupContent);
                
                // Add to appropriate layer
                layers.disasterLayers[`${disaster.type}Layer`].addLayer(marker);
                layers.clusters.disasterCluster.addLayer(marker);
            });
            
            // Add resources to the map
            resources.forEach(resource => {
                const marker = L.marker(resource.location, {
                    icon: createResourceIcon(resource.type)
                });
                
                const popupContent = `
                    <div class="map-info-window">
                        <h3 class="info-window-title">${resource.name}</h3>
                        <div class="info-window-subtitle">
                            <i class="fas fa-${resource.type === 'shelter' ? 'house' : 
                                              resource.type === 'medical' ? 'hospital' : 
                                              resource.type === 'food' ? 'utensils' : 'people-carry'}"></i>
                            ${resource.type.charAt(0).toUpperCase() + resource.type.slice(1)} | Status: ${resource.status}
                        </div>
                        <div class="info-window-content">
                            <p><strong>Capacity:</strong> ${resource.capacity} people</p>
                            <p><strong>Contact:</strong> ${resource.contact}</p>
                            <p><strong>Needs:</strong> ${resource.needs}</p>
                        </div>
                        <div class="info-window-footer">
                            <a href="#" class="info-window-btn">More Info</a>
                        </div>
                    </div>
                `;
                
                marker.bindPopup(popupContent);
                
                // Add to appropriate layer
                layers.resourceLayers[`${resource.type}Layer`].addLayer(marker);
                layers.clusters.resourceCluster.addLayer(marker);
            });
        };

        // UI Controls Management
        const setupUIControls = (map, baseLayers) => {
            // Map controls panel toggle
            const toggleControls = document.getElementById('toggleControls');
            const mapControlPanel = document.getElementById('mapControlPanel');
            const closePanel = document.getElementById('closePanel');
            
            toggleControls.addEventListener('click', function() {
                mapControlPanel.style.display = mapControlPanel.style.display === 'none' ? 'block' : 'none';
            });
            
            closePanel.addEventListener('click', function() {
                mapControlPanel.style.display = 'none';
            });
            
            // Layer control functionality
            document.querySelectorAll('.layer-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    // Remove active class from all buttons
                    document.querySelectorAll('.layer-btn').forEach(b => b.classList.remove('active'));
                    
                    // Add active class to clicked button
                    this.classList.add('active');
                    
                    // Change base layer
                    const layer = this.dataset.layer;
                    Object.values(baseLayers).forEach(l => map.removeLayer(l));
                    baseLayers[layer.charAt(0).toUpperCase() + layer.slice(1)].addTo(map);
                });
            });
            
            // Filter functionality
            document.querySelectorAll('.filter-option input[type="checkbox"]').forEach(checkbox => {
                checkbox.addEventListener('change', function() {
                    const filterId = this.id;
                    const layerType = filterId.replace('Filter', '');
                    const layerGroup = layerType.includes('flood') || layerType.includes('wildfire') || 
                                      layerType.includes('earthquake') || layerType.includes('hurricane') ?
                                      window.disasterLayers[`${layerType}Layer`] : 
                                      window.resourceLayers[`${layerType}Layer`];
                    
                    // Add or remove layer from map based on checkbox
                    this.checked ? map.addLayer(layerGroup) : map.removeLayer(layerGroup);
                });
            });
            
            // Search functionality
            const searchControl = new L.Control.Search({
                position: 'topleft',
                layer: L.layerGroup([...window.disasterCluster.getLayers(), ...window.resourceCluster.getLayers()]),
                propertyName: 'name',
                initial: false,
                zoom: 12,
                marker: false,
                textPlaceholder: 'Search location or incident...'
            });
            
            searchControl.on('search:locationfound', function(e) {
                e.layer.openPopup();
            });
            
            map.addControl(searchControl);
            
            // Update search input to match our custom search bar
            document.getElementById('mapSearch').addEventListener('input', function() {
                searchControl.search(this.value);
            });
            
            // Geolocation button
            const geoBtn = L.easyButton({
                position: 'topright',
                leafletClasses: true,
                states: [{
                    stateName: 'locate-me',
                    icon: 'fas fa-location-arrow',
                    title: 'Locate me',
                    onClick: function(btn, map) {
                        map.locate({setView: true, maxZoom: 13});
                    }
                }]
            }).addTo(map);
            
            // Handle location found
            map.on('locationfound', function(e) {
                L.marker(e.latlng, {
                    icon: L.divIcon({
                        className: 'user-location-icon',
                        html: `<div style="background: #3a0ca3; 
                                         width: 16px; 
                                         height: 16px; 
                                         border-radius: 50%; 
                                         border: 2px solid white;
                                         box-shadow: 0 0 5px rgba(0,0,0,0.5);"></div>`,
                        iconSize: [20, 20],
                        iconAnchor: [10, 10]
                    })
                }).addTo(map)
                .bindPopup("Your location").openPopup();
            });
            
            // Handle location error
            map.on('locationerror', function(e) {
                alert("Unable to determine your location: " + e.message);
            });
        };

        // Emergency Modal Functions
        const setupEmergencyModal = () => {
            const emergencyBtn = document.getElementById('emergencyBtn');
            const emergencyModal = document.getElementById('emergencyModal');
            const closeModal = document.getElementById('closeModal');
            const callStatus = document.getElementById('callStatus');
            const callNowBtn = document.getElementById('callNowBtn');
            
            // Device detection
            const isMobile = /iPhone|iPad|iPod|Android/i.test(navigator.userAgent);
            
            // Emergency Button Click Handler
            emergencyBtn.addEventListener('click', function(e) {
                if(isMobile) {
                    // On mobile, let default tel: link handle the call
                    return true;
                } else {
                    // On desktop, show modal
                    e.preventDefault();
                    emergencyModal.classList.add('active');
                    
                    // Simulate connection status
                    setTimeout(() => {
                        callStatus.innerHTML = `
                            <i class="fas fa-check-circle"></i>
                            <span>Emergency line ready - call now or choose another option</span>
                        `;
                        callStatus.classList.remove('status-connecting');
                        callStatus.classList.add('status-connected');
                    }, 1500);
                }
            });
            
            // Close Modal
            closeModal.addEventListener('click', function() {
                emergencyModal.classList.remove('active');
            });
            
            // Close modal when clicking outside
            emergencyModal.addEventListener('click', function(e) {
                if(e.target === emergencyModal) {
                    emergencyModal.classList.remove('active');
                }
            });
            
            // Call Now Button
            callNowBtn.addEventListener('click', function() {
                // In production, this would initiate a WebRTC call
                alert("In production: Would connect to emergency services via WebRTC");
            });
            
            // Other Option Buttons
            document.getElementById('requestCallbackBtn').addEventListener('click', function() {
                alert("Callback request would be sent to emergency team");
            });
            
            document.getElementById('smsHelpBtn').addEventListener('click', function() {
                window.location.href = 'sms:+11234567890?body=HELP';
            });
            
            document.getElementById('whatsappBtn').addEventListener('click', function() {
                window.open('https://wa.me/11234567890?text=Emergency%20assistance%20needed');
            });
            
            document.getElementById('local911Btn').addEventListener('click', function() {
                alert("Would show local emergency numbers based on user's location");
            });
            
            // Update Call Status Badge
            function updateCallStatus() {
                const statuses = [
                    {text: "LIVE", color: "#4CAF50"},
                    {text: "HIGH VOLUME", color: "#FF9800"},
                    {text: "2 MIN WAIT", color: "#FF9800"}
                ];
                const randomStatus = statuses[Math.floor(Math.random() * statuses.length)];
                document.getElementById('callStatusBadge').innerHTML = `
                    <i class="fas fa-circle" style="color: ${randomStatus.color}; font-size: 0.6em;"></i>
                    ${randomStatus.text}
                `;
            }
            
            // Initialize status updates every 30 seconds
            updateCallStatus();
            setInterval(updateCallStatus, 30000);
        };

        // Initialize the application
        document.addEventListener('DOMContentLoaded', () => {
            // Initialize map and get references
            const { map, baseLayers } = initializeMap();
            
            // Setup layers and get references
            const { disasterLayers, resourceLayers, clusters } = setupLayers(map);
            
            // Make layers globally available for filter controls
            window.disasterLayers = disasterLayers;
            window.resourceLayers = resourceLayers;
            window.disasterCluster = clusters.disasterCluster;
            window.resourceCluster = clusters.resourceCluster;
            
            // Populate map with data
            populateMapData(map, { disasterLayers, resourceLayers, clusters });
            
            // Setup UI controls
            setupUIControls(map, baseLayers);
            
            // Setup emergency modal
            setupEmergencyModal();
            
            // Button click animation
            document.querySelectorAll('.btn').forEach(button => {
                button.addEventListener('click', (e) => {
                    e.target.style.transform = 'scale(0.98)';
                    setTimeout(() => {
                        e.target.style.transform = '';
                    }, 200);
                });
            });
        });
    </script>
</body>
</html>